-- TABLE ASISTENCIA
CREATE TABLE ASISTENCIA
(ID NUMBER(12) CONSTRAINT PK_ASIST PRIMARY KEY,
 CEDULA   VARCHAR2(12) NOT NULL,
 HORA_ENTRADA DATE,
 HORA_SALIDA  DATE);

-- TABLE AREA
CREATE TABLE AREA(
  ID NUMBER(6) NOT NULL CONSTRAINT PKAREAS1 PRIMARY KEY,
  NOMBRE_AREA VARCHAR2(40 ) NOT NULL,
  FECHA_CREA DATE NOT NULL,
  ACTIVA VARCHAR2(1 ) DEFAULT 'S'  NOT NULL,
  ID_AREA_SUPERIOR NUMBER(6)
)
/


-- TABLE CATEGORIA_SALARIAL

CREATE TABLE CATEGORIA_SALARIAL(
  COD_CATEGORIA NUMBER(6) NOT NULL CONSTRAINT PKCATEG_SALARIAL1 PRIMARY KEY,
  NOMBRE_CATEGORIA VARCHAR2(30 ) NOT NULL,
  TIPO_CATEGORIA VARCHAR2(2 ) NOT NULL,
  SALARIO NUMBER(8) NOT NULL,
  ACTIVA DATE NOT NULL
)
/
-- TABLE EMPLEADO

CREATE TABLE EMPLEADO(
  CEDULA VARCHAR2(12 ) NOT NULL CONSTRAINT PKEMPLEADOS1 PRIMARY KEY,
  NOMBRE VARCHAR2(30 ) NOT NULL,
  APELLIDO VARCHAR2(30 ) NOT NULL,
  FECHA_INGRESO DATE NOT NULL,
  FECHA_NACIM DATE NOT NULL,
  TELEFONO VARCHAR2(15 ) NOT NULL,
  DIRECCION VARCHAR2(60 ) NOT NULL,
  BARRIO VARCHAR2(100 ) NOT NULL,
  HORARIO_ENTRADA VARCHAR2(2 ) NOT NULL,
  HORARIO_SALIDA VARCHAR2(2 ) NOT NULL,
  CEDULA_JEFE VARCHAR2(12 ),
  ID_LOCALIDAD NUMBER(8)
)
/

  

-- TABLE LIQUIDACION_MENSUAL

CREATE TABLE LIQUIDACION_MENSUAL(
  ID NUMBER(8) NOT NULL CONSTRAINT PKLIQUIDACION1 PRIMARY KEY,
  FECHA_LIQUIDACION DATE DEFAULT SYSDATE NOT NULL,
  ANIO NUMBER(4) DEFAULT 0 NOT NULL,
  MES NUMBER(2) DEFAULT 1 NOT NULL
        CONSTRAINT CK_MES71 CHECK (MES BETWEEN 1 AND 12)
)
/

-- TABLE LOCALIDAD

CREATE TABLE LOCALIDAD(
  ID_LOCALIDAD NUMBER(8) NOT NULL CONSTRAINT PKLOCALIDAD1 PRIMARY KEY,
  NOMBRE VARCHAR2(40 ) NOT NULL,
  COD_DEPARTAMENTO NUMBER(2)
)
/


-- TABLE PLANILLA

CREATE TABLE PLANILLA(
  ID_LIQUIDACION NUMBER(8) NOT NULL,
  CEDULA VARCHAR2(12 ) NOT NULL,
  SALARIO_BASICO NUMBER(8) DEFAULT 0 NOT NULL,
  DESCUENTO_IPS NUMBER(8) DEFAULT 0 NOT NULL,
  DESCUENTOS NUMBER(8) DEFAULT 0 NOT NULL,
  GRATIFICACIONES NUMBER(8) DEFAULT 0 NOT NULL,
  HORAS_EXTRAS NUMBER(8) DEFAULT 0 NOT NULL,
  LIQUIDO_COBRADO NUMBER(8) DEFAULT 0 NOT NULL,
  CONSTRAINT PK_PLANILLA1 PRIMARY KEY (ID_LIQUIDACION, CEDULA)
)
/

-- TABLE CARGO_ACTUAL

CREATE TABLE CARGO_ACTUAL(
  ID NUMBER(10) NOT NULL CONSTRAINT PKCARGO_ACTUAL1 PRIMARY KEY,
  COD_CATEGORIA NUMBER(6) NOT NULL,
  CEDULA VARCHAR2(12 ) NOT NULL,
  ID_AREA NUMBER(6) NOT NULL,
  FECHA_INI DATE NOT NULL,
  FECHA_FIN DATE
)
/

-- TABLE DEPENDIENTES

CREATE TABLE DEPENDIENTES(
  CEDULA VARCHAR2(12 ) NOT NULL,
  CEDULA_DEPEN NUMBER(8) NOT NULL,
  NOMBRE VARCHAR2(40 ) NOT NULL,
  APELLIDO VARCHAR2(40 ) NOT NULL,
  FECHA_NACIMIENTO DATE NOT NULL,
  FECHA_ACTUALIZ DATE DEFAULT SYSDATE,
  CONSTRAINT PKDEPENDIENTES1 PRIMARY KEY (CEDULA_DEPEN,CEDULA)
)
/

-- TABLE JUSTIFICATIVO

CREATE TABLE JUSTIFICATIVO(
  ID NUMBER(8),
  CEDULA VARCHAR2(12 ) NOT NULL,
  COD_EVENTO NUMBER(3) NOT NULL,
  DESCRIPCION_EVENTO VARCHAR2(500 ) NOT NULL,
  FECHA_INICIO DATE NOT NULL,
  DURACION NUMBER(3) DEFAULT 0 NOT NULL,
 CONSTRAINT PKLEGAJO PRIMARY KEY (ID,COD_EVENTO)
)
/

 

-- TABLE TIPO_EVENTO

CREATE TABLE TIPO_EVENTO(
  COD_EVENTO NUMBER(3) NOT NULL CONSTRAINT PK_EVENTO PRIMARY KEY,
  NOMBRE_EVENTO VARCHAR2(50 ) NOT NULL,
  COBERTURA_IPS VARCHAR2(1 ) DEFAULT 'N' NOT NULL
)
/


-- TABLE FERIADO

CREATE TABLE FERIADO(
  FECHA DATE NOT NULL CONSTRAINT PK_FERIADO PRIMARY KEY
)
/

-- TABLE PARAMETROS

CREATE TABLE PARAMETROS(
  SALARIO_MINIMO NUMBER(8) NOT NULL,
  GRATIFICACION_FAMILIAR NUMBER(8) NOT NULL,
  DIAS_PERMISO_MATERNIDAD NUMBER(2) NOT NULL,
  DIAS_OTROS_PERMISOS NUMBER(2) NOT NULL
)
/
ALTER TABLE EMPLEADO ADD
(CONSTRAINT FK_LOC_EMPLE FOREIGN KEY(ID_LOCALIDAD) REFERENCES 
LOCALIDAD (ID_LOCALIDAD));

ALTER TABLE EMPLEADO ADD
(CONSTRAINT FK_EMP_EMP FOREIGN KEY (CEDULA_JEFE) REFERENCES EMPLEADO (CEDULA));

ALTER TABLE ASISTENCIA ADD
(CONSTRAINT FK_EMP_ASIST FOREIGN KEY (CEDULA) REFERENCES EMPLEADO (CEDULA));

ALTER TABLE DEPENDIENTES ADD
(CONSTRAINT FK_EMP_DEPEN FOREIGN KEY (CEDULA) REFERENCES EMPLEADO (CEDULA));

ALTER TABLE CARGO_ACTUAL ADD
(CONSTRAINT FK_EMP_CARGO FOREIGN KEY (CEDULA) REFERENCES EMPLEADO (CEDULA));

ALTER TABLE CARGO_ACTUAL ADD
(CONSTRAINT FK_EMP_CATEG FOREIGN KEY (COD_CATEGORIA) REFERENCES CATEGORIA_SALARIAL(COD_CATEGORIA));

ALTER TABLE CARGO_ACTUAL ADD
(CONSTRAINT FK_AREA_CARG FOREIGN KEY (ID_AREA) REFERENCES AREA(ID));

ALTER TABLE PLANILLA ADD
(CONSTRAINT FK_EMP_PLA FOREIGN KEY (CEDULA) REFERENCES EMPLEADO (CEDULA));

ALTER TABLE PLANILLA ADD
(CONSTRAINT FK_LIQ_PLA FOREIGN KEY(ID_LIQUIDACION) REFERENCES
LIQUIDACION_MENSUAL (ID));

ALTER TABLE JUSTIFICATIVO ADD
(CONSTRAINT FK_EMP_JUSTI FOREIGN KEY (CEDULA) REFERENCES EMPLEADO (CEDULA));

ALTER TABLE JUSTIFICATIVO ADD
(CONSTRAINT FK_TIP_JUSTI FOREIGN KEY (COD_EVENTO) REFERENCES TIPO_EVENTO(COD_EVENTO));


INSERT INTO EMPLEADO (CEDULA,NOMBRE,APELLIDO,FECHA_INGRESO,FECHA_NACIM,TELEFONO,DIRECCION,BARRIO,HORARIO_ENTRADA,HORARIO_SALIDA,CEDULA_JEFE,ID_LOCALIDAD)
SELECT T.CEDULA,T.NOMBRE,T.APELLIDO,TRUNC(T.FECHA_ING),TRUNC(T.FECHA_NACIM),T.TELEFONO,T.DIRECCION,T.BARRIO,'07','17',T.CEDULA_JEFE,T.ID_LOCALIDAD
FROM B_EMPLEADOS T;

COMMIT;
